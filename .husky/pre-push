#!/usr/bin/env sh
set -euo pipefail

echo "[husky pre-push] Lint + iteration + migrations"

# Run ESLint (cached) and fail on warnings
npx eslint --cache --max-warnings=0

# Optional: ensure system info updated (light governance)
npm run check:iteration || true

# Ensure Drizzle migrations are consistent
node scripts/check-migrations.mjs

echo "[husky pre-push] OK"
